package com.smoketestcases;

import java.io.IOException;
import org.testng.Assert;
import org.testng.ITestResult;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.AfterTest;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;
import com.testbase.TestBase;
import com.pages.LoginPage;
import com.relevantcodes.extentreports.ExtentReports;
import com.relevantcodes.extentreports.ExtentTest;
import com.relevantcodes.extentreports.LogStatus;
import com.utilities.Utility;
import com.wrapper.Wrapper;


public class AddScreenshotToReport extends TestBase {
	
	LoginPage loginpage;
	Wrapper objWrapperTest;
	Utility objUtilities;
	public ExtentReports extent;
	public ExtentTest extentTest;
	
	
	public AddScreenshotToReport() {
	super();
	}
	
	@BeforeTest
	public void setExtent() {
	extent = new ExtentReports(System.getProperty("user.dir") + "/test-output/ExtentReport.html", true);
	extent.addSystemInfo("Host Name", "Jintu");
	extent.addSystemInfo("User Name", "Jintu");
	extent.addSystemInfo("Environment", "Learning");
	}
	@BeforeClass
	public void setUp() {
	initialization();
	homePage = new HomePage();
	objWrapperTest = new Wrapper();
	objUtilities = new Utility();
	}
	
	@Test(priority = 1)
	public void ClickOnFrom() throws InterruptedException {
		extentTest = extent.startTest("ClickOnFrom");
		homePage.clickFrom("Cochin");
		Assert.assertEquals(homePage.getFrom(), "Cochin");
	}
	@Test(priority = 2)
	
	public void ClickOnTo() throws InterruptedException {
		extentTest = extent.startTest("ClickOnTo");
		homePage.clickTo("Bengaluru International Airport");
		Assert.assertEquals(homePage.getTo(), "Bangalore");
	}
	
	@Test(priority = 3)
	
	public void ClickOnDate() throws InterruptedException 
	{
		extentTest = extent.startTest("ClickOnDate");
        homePage.SelectMonth("OCTOBER 2023");
		Thread.sleep(5000);
        homePage.clickDep("23");
		Assert.assertEquals(homePage.getDep(), "23 Octâ€™23");
	}
	
	@Test(priority = 4)
	
	public void ClickOnTraveller() {
		extentTest = extent.startTest("ClickOnTraveller");
		homePage.addAdults(2);
		homePage.addChildren(1);
		homePage.addInfant(1);
		homePage.clickApplyButton();
		String pText = homePage.getTravellerText();
		Assert.assertEquals(pText, "5 Travellers");

	}
	
	@AfterMethod
	public void tearDown(ITestResult result) throws IOException {
	if (result.getStatus() == ITestResult.FAILURE) {
	extentTest.log(LogStatus.FAIL, "TEST CASE FAILED IS " + result.getName());
	extentTest.log(LogStatus.FAIL, "TEST CASE FAILED IS " + result.getThrowable());
	String screenshotPath = objUtilities.getScreenshot(driver, result.getName());
	extentTest.log(LogStatus.FAIL, extentTest.addScreenCapture(screenshotPath));
	} else if (result.getStatus() == ITestResult.SKIP) {
	extentTest.log(LogStatus.SKIP, "Test Case SKIPPED IS " + result.getName());
	} else if (result.getStatus() == ITestResult.SUCCESS) {
	extentTest.log(LogStatus.PASS, "Test Case PASSED IS " + result.getName());
	String screenshotPath = objUtilities.getScreenshot(driver, result.getName());
	extentTest.log(LogStatus.PASS, extentTest.addScreenCapture(screenshotPath));
	}
	extent.endTest(extentTest);
	}
	@AfterTest
	public void endReport() {
	extent.flush();
	extent.close();
	driver.quit();
	}



}
